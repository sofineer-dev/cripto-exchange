<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crypto Exchange1111</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 20px; 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            height: 100vh; 
            background-color: #f3f4f6; 
			
        }
        .card {
            background: white; 
            border-radius: 10px; 
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1); 
            padding: 20px; 
            width: 400px; 
        }
        h1 {
            text-align: center; 
            color: #333; 
        }
        .row {
            display: flex; 
            justify-content: space-between; 
            margin-bottom: 15px;
        }
        .column {
            flex: 1; 
            margin-right: 10px; 
        }
        .column:last-child {
            margin-right: 0; 
        }
        label {
            color: #666; 
            margin-bottom: 5px; 
        }
        .currency-display {
            padding: 10px; 
            border: 1px solid #ccc; 
            border-radius: 5px; 
            width: 100%;
            cursor: pointer;
            display: flex;
            align-items: center;
        }
        #result {
            text-align: center; 
            margin-top: 20px; 
            color: #28a745; 
        }
        .spinner {
            display: none; 
            text-align: center; 
            margin-top: 10px; 
        }
        .crypto-option {
            display: flex;
            align-items: center;
        }
        .crypto-option img {
            width: 20px; 
            height: 20px; 
            margin-right: 10px; 
        }
        .custom-select {
            display: flex;
            flex-direction: column;
            position: relative;
        }
        .select-dropdown {
            position: absolute;
            background: white;
            border: 1px solid #ccc;
            border-radius: 5px;
            width: 100%;
            z-index: 1000;
            max-height: 200px;
            overflow-y: auto;
            display: none;
        }
        .select-dropdown div {
            padding: 10px;
            cursor: pointer;
        }
        .select-dropdown div:hover {
            background-color: #f0f0f0;
        }
    </style>
</head>
<body>

<div class="card">
    <h1>Crypto Exchange</h1>
    
    <div class="row">
        <div class="column">
            <label for="amount">Amount:</label>
            <input type="number" id="amount" value="1" />
        </div>
        <div class="column custom-select">
            <label for="from">From:</label>
            <div id="from" class="currency-display" onclick="toggleDropdown('from')">
                <span>Currency</span>
            </div>
            <div class="select-dropdown" id="fromDropdown"></div>
        </div>
    </div>

    <div class="row">
        <div class="column">
            <div class="currency-display" id="result" disabled></div>
        </div>
        <div class="column custom-select">
            <label for="to">To:</label>
            <div id="to" class="currency-display" onclick="toggleDropdown('to')">
                <span>Currency</span>
            </div>
            <div class="select-dropdown" id="toDropdown"></div>
        </div>
    </div>
    
    <div class="spinner" id="spinner">ðŸ”„ Loading...</div>
    <button class="btn btn-primary" id="convertBtn">Convert</button>
</div>

<script>
    const apiURL = 'https://api.coingecko.com/api/v3/coins/markets?vs_currency=usd&order=market_cap_desc&per_page=100&page=1&sparkline=false';
    let coins = [];

    async function fetchPrices() {
        const response = await fetch(apiURL);
        coins = await response.json();
    }

    async function populateSelects() {
        await fetchPrices();
        const fromDropdown = document.getElementById('fromDropdown');
        const toDropdown = document.getElementById('toDropdown');

        coins.forEach(coin => {
            const optionFrom = document.createElement('div');
            optionFrom.className = 'crypto-option';
            optionFrom.innerHTML = `<img src="${coin.image}" alt="${coin.name} icon"/> ${coin.name} (${coin.symbol.toUpperCase()})`;
            optionFrom.onclick = () => selectCurrency(coin.id, coin.name, 'from', coin.image);
            fromDropdown.appendChild(optionFrom);

            const optionTo = document.createElement('div');
            optionTo.className = 'crypto-option';
            optionTo.innerHTML = `<img src="${coin.image}" alt="${coin.name} icon"/> ${coin.name} (${coin.symbol.toUpperCase()})`;
            optionTo.onclick = () => selectCurrency(coin.id, coin.name, 'to', coin.image);
            toDropdown.appendChild(optionTo);
        });
    }

    function selectCurrency(id, name, type, image) {
        const displayDiv = document.querySelector(`#${type}`);
        displayDiv.innerHTML = `${name} <img src="${image}" alt="${name} icon" style="width: 20px; height: 20px; vertical-align: middle;"/>`;
        document.querySelector(`#${type}Dropdown`).style.display = 'none';
        document.getElementById(type).setAttribute('data-value', id);
        updateResult();
    }

    function toggleDropdown(type) {
        const dropdown = document.querySelector(`#${type}Dropdown`);
        dropdown.style.display = dropdown.style.display === 'block' ? 'none' : 'block';
    }

    document.addEventListener('click', (e) => {
        if (!e.target.closest('.custom-select')) {
            document.querySelectorAll('.select-dropdown').forEach(dropdown => {
                dropdown.style.display = 'none';
            });
        }
    });

    async function updateResult() {
        const amount = document.getElementById('amount').value;
        const fromCurrency = document.getElementById('from').getAttribute('data-value');
        const toCurrency = document.getElementById('to').getAttribute('data-value');

        const spinner = document.getElementById('spinner');
        const resultField = document.getElementById('result');

        if (fromCurrency && toCurrency && fromCurrency !== toCurrency) {
            spinner.style.display = 'block';
            resultField.innerHTML = ''; // Clear previous result

            const priceMap = {};
            const coinMap = {};
            coins.forEach(coin => {
                priceMap[coin.id] = coin.current_price;
                coinMap[coin.id] = coin.image; // Store image for later use
            });

            const fromPrice = priceMap[fromCurrency];
            const toPrice = priceMap[toCurrency];
            const result = (amount * fromPrice) / toPrice;

            spinner.style.display = 'none';
            resultField.innerHTML = `${result.toFixed(6)} <img src="${coinMap[toCurrency]}" alt="icon" style="width: 20px; height: 20px; vertical-align: middle;"/>`;
        } else {
            resultField.innerHTML = 'Select different currencies to convert.';
        }
    }

    document.getElementById('amount').addEventListener('input', updateResult);
    document.getElementById('convertBtn').addEventListener('click', updateResult);

    // Populate the selects on page load
    populateSelects();
</script>

</body>
</html>
